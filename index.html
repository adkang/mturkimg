<html>
	<head>
		<script src="text/javascript"></script>
		<script src="mturk.js"></script>
		<script>
			var numclicks = 0;
    			var keydowns = 0;

      			var addedelements = [];

    			$(document).ready(function() {
    			$("#theimage").click(function(e) {
          		numclicks++;
          		$("#numberofpeople").text(numclicks);
          		$("#numberofpeoplefield").val(numclicks);

          		var newdomelement = $("<div class='marker'></div>");
          		newdomelement.css("left", (e.pageX-3) + "px");
          		newdomelement.css("top", (e.pageY-3) + "px");

          		var currhistory = $("#history").val();
          		currhistory += "|" + e.pageX + "," + e.pageY + "|";
          		$("#history").val(currhistory);

          		newdomelement.click(removeElementEvent);

          		$("body").append(newdomelement);

          		// add to history
          		addedelements.push(newdomelement);
    				})
    				$(document).keydown(function(e) {
    					keydowns++;
    					$("#numkeydowns").val(keydowns);

          		console.log(e);

          		if(e.key=="z" && e.ctrlKey) {
            			var elem2remove = addedelements.pop();
            			removeElement(elem2remove);
          		}
    				})
    		})
	
      function removeElement(elem) {
        $(elem).remove();

        numclicks--;
        $("#numberofpeople").text(numclicks);
        $("#numberofpeoplefield").val(numclicks);       
      }

      function removeElementEvent(e) {
        removeElement(this);
      }
    
	</script>
	<style>
		
    	.marker {
    	  border: 2px solid red;
    	  border-radius: 5px;
    	  width: 2px;
    	  height: 2px;
    	  position: absolute;
    	  left: 0px;
    	  top: 0px;
    	}
	</style>
	</head>
	<body style>
		<h1>How many recognizable people are in each image? Please look at each image carefully.</h1>
		
		<p>Example 1: 5 people<br><img src="example1.jpg" alt="#1" width=512></p>
		
		<p>Example 2: 6 people<br><img src="example2.jpg" alt="#2" width=512></p>
		
		<p>Example 3: 3 people<br><img src="example3.jpeg" alt="#2" width=512></p>
    
		<p>#1<br><img src="people1.jpg" alt="#1" width=512></p>

		<p>#2<br><img src="people2.jpg" alt="#2" width=512></p>

		<p>#3<br><img src="people3.jpg" alt="#3" width=512></p>

		<p>#4<br><img src="people4.jpg" alt="#4" width=512></p>

		<p>#5<br><img src="people5.png" alt="#5" width=512></p>

		<p>#6<br><img src="people6.jpg" alt="#6" width=512></p>
		<p><span id="numberofpeople">0</span> people found</p>

		<p>#7<br><img src="people7.jpg" alt="#7" width=512></p>
		
		<form id="mturk_form">
			<p>
				<input id="numclickfield" type="hidden" name="numclicks">
				<input id="numkeydowns" type="hidden" name="keydowns">
				<input id="numberofpoeplefield" type="hidden" name="numberofpeople">
				<input id="history" type="hidden" name="history">
			</p>
		<textarea name="people" style="width:250px;height:150px;"></textarea>
		<input type="submit">
		</form>
	</body>
</html>
